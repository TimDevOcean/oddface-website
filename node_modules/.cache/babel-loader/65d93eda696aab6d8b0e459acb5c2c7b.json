{"ast":null,"code":"import _defineProperty from\"/Users/TIM/Desktop/DEXTOP/CODE PROJECTS/oddface/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import React from'react';import PaystackPop from'@paystack/inline-js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Payment=function Payment(_ref){var user=_ref.user,checkoutData=_ref.checkoutData,handleBackStep=_ref.handleBackStep,handleNextStep=_ref.handleNextStep,handleCheckout=_ref.handleCheckout;var sanitizedLineItems=function sanitizedLineItems(lineItems){return lineItems.reduce(function(data,lineItem){var item=data;var variantData=null;if(lineItem.selected_options.length){variantData=_defineProperty({},lineItem.selected_options[0].group_id,lineItem.selected_options[0].option_id);}item[lineItem.id]={quantity:lineItem.quantity,variants:variantData};return item;},{});};var orderSubTotal=checkoutData.live.subtotal.raw+user.shippingOption.price;var totalAmount=orderSubTotal*100;var currency=checkoutData.live.currency.symbol;var paystackPay=function paystackPay(e){e.preventDefault();var paystack=new PaystackPop();paystack.newTransaction({key:process.env.REACT_APP_PAYSTACK_PUBLIC_KEY,amount:totalAmount,firstname:user.firstName,lastname:user.lastName,email:user.email,onSuccess:function onSuccess(transaction){var orderData={payment:{gateway:\"paystack\",paystack:{payment_method_id:\"gway_6oLdBVDBm94zoX\",reference:transaction.reference}},shipping:{name:user.firstName+\" \"+user.lastName,street:user.address,town_city:user.city,county_state:''+user.shippingSubdivision.code+'',postal_zip_code:user.postcode,country:''+user.shippingCountry.code+''},customer:{firstname:user.firstName,lastname:user.lastName,email:user.email},line_items:sanitizedLineItems(checkoutData.live.line_items),fulfillment:{shipping_method:user.shippingOption.id}};console.log(orderData);handleCheckout(checkoutData.id,orderData);handleNextStep(e,\"confirmation\");},onCancel:function onCancel(){console.log(\"Transaction has been canceled.\");}});};return/*#__PURE__*/_jsxs(\"div\",{className:\"actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return handleBackStep(e,\"order-details\");},children:\"Back\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:paystackPay,children:[\"Pay \",currency,orderSubTotal.toFixed(2)]})]});};export default Payment;","map":{"version":3,"names":["React","PaystackPop","Payment","user","checkoutData","handleBackStep","handleNextStep","handleCheckout","sanitizedLineItems","lineItems","reduce","data","lineItem","item","variantData","selected_options","length","group_id","option_id","id","quantity","variants","orderSubTotal","live","subtotal","raw","shippingOption","price","totalAmount","currency","symbol","paystackPay","e","preventDefault","paystack","newTransaction","key","process","env","REACT_APP_PAYSTACK_PUBLIC_KEY","amount","firstname","firstName","lastname","lastName","email","onSuccess","transaction","orderData","payment","gateway","payment_method_id","reference","shipping","name","street","address","town_city","city","county_state","shippingSubdivision","code","postal_zip_code","postcode","country","shippingCountry","customer","line_items","fulfillment","shipping_method","console","log","onCancel","toFixed"],"sources":["/Users/TIM/Desktop/DEXTOP/CODE PROJECTS/oddface/src/components/checkout/Payment.js"],"sourcesContent":["import React from 'react';\nimport PaystackPop from '@paystack/inline-js';\n\nconst Payment = ({\n    user,\n    checkoutData,\n    handleBackStep,\n    handleNextStep,\n    handleCheckout\n  }) => {\n  \n\n    const sanitizedLineItems = (lineItems) => {\n        return lineItems.reduce((data, lineItem) => {\n          const item = data;\n          let variantData = null;\n          if (lineItem.selected_options.length) {\n            variantData = {\n              [lineItem.selected_options[0].group_id]: lineItem.selected_options[0].option_id,\n            };\n          }\n          item[lineItem.id] = {\n            quantity: lineItem.quantity,\n            variants: variantData,\n          };\n        return item;\n        }, {});\n      };\n\n    const orderSubTotal =  checkoutData.live.subtotal.raw + user.shippingOption.price\n    const totalAmount =  orderSubTotal * 100;\n    const currency = checkoutData.live.currency.symbol;\n\n\n\n    const paystackPay = (e) => {\n        e.preventDefault()\n        \n        \n        const paystack = new PaystackPop();\n        paystack.newTransaction({\n            key: process.env.REACT_APP_PAYSTACK_PUBLIC_KEY,\n            amount: totalAmount,\n            firstname: user.firstName,\n            lastname: user.lastName,\n            email: user.email,\n            onSuccess(transaction){\n\n                const orderData = {\n                    payment: {\n                      gateway: \"paystack\",\n                      paystack: {\n                        payment_method_id: \"gway_6oLdBVDBm94zoX\",\n                        reference: transaction.reference,\n                      },\n                    },\n                    shipping: {\n                      name: user.firstName + \" \" + user.lastName,\n                      street: user.address,\n                      town_city: user.city,\n                      county_state: '' + user.shippingSubdivision.code  + '',\n                      postal_zip_code: user.postcode,\n                      country: '' + user.shippingCountry.code + ''\n                    },\n                    customer: {\n                      firstname: user.firstName,\n                      lastname: user.lastName,\n                      email: user.email,\n                    },\n                    line_items: sanitizedLineItems(checkoutData.live.line_items),\n                    fulfillment: { shipping_method: user.shippingOption.id  }\n                  };\n                  \n\n                console.log(orderData);\n                handleCheckout(checkoutData.id, orderData);\n                handleNextStep(e, \"confirmation\");\n            },\n            onCancel(){\n                console.log(\"Transaction has been canceled.\")\n            }\n        })\n\n    }\n\n\n    return (\n        <div className='actions'>\n            <button\n                  onClick={(e) => handleBackStep(e, \"order-details\")}\n                >\n                  Back\n            </button>\n\n            <button onClick={paystackPay}>\n                  Pay {currency}{orderSubTotal.toFixed(2)}\n            </button>\n        </div>\n    )\n};\n\n\n\nexport default Payment;"],"mappings":"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"},"metadata":{},"sourceType":"module"}